#!/bin/bash
# bin/compile <build-dir> <cache-dir> <env-dir>

indent() {
  sed -u 's/^/       /'
}

echo "-----> Found .release file"

while read line; do
  if [ ! -z line ]: then 
    echo "Provisioning $url" | indent
    
    # Download
    curl -L --silent -o $1/binary $url
    if [ ! -f $1/binary ]; then 
      echo "Cannot download the binary"
      exit 1
    fi

    # Execute
    bash $1/binary
    exit $?
  fi
done < .release
